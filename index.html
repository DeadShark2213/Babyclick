<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PvZ Game Prototype</title>
  <style>
    body { background: #263238; color: #fff; font-family: Arial, sans-serif; margin: 0; }
    #gameCanvas { background: #567d46; display: block; margin: 20px auto; border: 4px solid #222; }
    .plant-select { margin: 10px; }
    .plant-btn { padding: 10px; margin-right: 8px; background: #8bc34a; border: none; border-radius: 6px; cursor: pointer; }
    .plant-btn.locked { background: #bbb; cursor: not-allowed; }
    #levelSelect { margin: 20px; }
  </style>
</head>
<body>
  <h1>Plants vs. Zombies: HTML Edition</h1>
  <div id="levelSelect">
    <label for="level">Choose Level:</label>
    <select id="level">
      <option value="1">Level 1</option>
      <option value="2">Level 2</option>
      <option value="3">Level 3</option>
    </select>
    <button onclick="startLevel()">Start Level</button>
  </div>
  <div class="plant-select" id="plantSelect"></div>
  <canvas id="gameCanvas" width="900" height="400"></canvas>
  <script>
    // Plant data & unlocks
    const plants = [
      { name: "Peashooter", unlockedAt: 1, color: "#4CAF50" },
      { name: "Sunflower", unlockedAt: 2, color: "#FFD600" },
      { name: "Cherry Bomb", unlockedAt: 3, color: "#D32F2F" }
    ];
    let currentLevel = 1;
    let selectedPlant = null;
    let plantsOnField = [];
    let zombies = [];
    let gameActive = false;

    function renderPlantButtons() {
      const container = document.getElementById('plantSelect');
      container.innerHTML = '';
      plants.forEach((plant, i) => {
        const btn = document.createElement('button');
        btn.textContent = plant.name + (currentLevel >= plant.unlockedAt ? "" : " (Locked)");
        btn.className = "plant-btn" + (currentLevel >= plant.unlockedAt ? "" : " locked");
        btn.disabled = currentLevel < plant.unlockedAt;
        btn.onclick = () => {
          if (currentLevel >= plant.unlockedAt) selectedPlant = plant;
        };
        container.appendChild(btn);
      });
    }

    document.getElementById('level').addEventListener('change', function() {
      currentLevel = parseInt(this.value);
      renderPlantButtons();
    });

    function startLevel() {
      gameActive = true;
      plantsOnField = [];
      zombies = [];
      spawnZombies(currentLevel);
      renderPlantButtons();
      drawGame();
    }

    function spawnZombies(level) {
      zombies = [];
      for (let i = 0; i < level * 3; i++) {
        zombies.push({
          x: 850 + Math.random() * 100,
          y: 50 + Math.random() * 300,
          hp: 3 + level,
          speed: 0.5 + level * 0.2
        });
      }
    }

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    canvas.addEventListener('click', function(e) {
      if (!selectedPlant || !gameActive) return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      plantsOnField.push({ ...selectedPlant, x, y, cooldown: 0 });
    });

    function drawGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw grid
      for (let i = 0; i < 9; i++) {
        ctx.strokeStyle = "#fff";
        ctx.strokeRect(i * 100, 0, 100, 400);
      }

      // Draw plants
      plantsOnField.forEach(plant => {
        ctx.beginPath();
        ctx.arc(plant.x, plant.y, 25, 0, 2 * Math.PI);
        ctx.fillStyle = plant.color;
        ctx.fill();
        ctx.strokeStyle = "#222";
        ctx.stroke();
        ctx.fillStyle = "#222";
        ctx.font = "14px Arial";
        ctx.fillText(plant.name[0], plant.x - 6, plant.y + 6);
      });

      // Draw zombies
      zombies.forEach(zombie => {
        ctx.fillStyle = "#607d8b";
        ctx.fillRect(zombie.x, zombie.y - 20, 40, 40);
        ctx.fillStyle = "#222";
        ctx.fillText("ðŸ§Ÿ", zombie.x + 8, zombie.y + 8);
      });

      // Move zombies
      zombies.forEach(zombie => {
        zombie.x -= zombie.speed;
      });

      // Check collisions (simple)
      plantsOnField.forEach(plant => {
        zombies.forEach(zombie => {
          if (Math.abs(plant.x - zombie.x) < 30 && Math.abs(plant.y - zombie.y) < 30) {
            zombie.hp -= 1;
          }
        });
      });

      // Remove defeated zombies
      zombies = zombies.filter(z => z.hp > 0 && z.x > 0);

      // Win/Lose detection
      if (gameActive && zombies.length === 0) {
        gameActive = false;
        alert("Level Cleared! Unlock new plants!");
      } else if (gameActive && zombies.some(z => z.x < 60)) {
        gameActive = false;
        alert("Zombies reached your house! Try again.");
      }

      if (gameActive) requestAnimationFrame(drawGame);
    }

    renderPlantButtons();
  </script>
</body>
</html>
