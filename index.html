<!DOCTYPE html>
<html>
<head>
  <title>Plants vs. Zombies - HTML Prototype</title>
  <style>
    body { font-family: Arial; background: #4cbb17; }
    #gameBoard {
      display: grid;
      grid-template-columns: repeat(9, 70px);
      grid-template-rows: repeat(5, 90px);
      gap: 2px;
      background: #7ac142;
      margin: 20px auto;
      width: 640px;
      height: 450px;
      border: 4px solid #3b3b3b;
      position: relative;
    }
    .cell {
      border: 1px solid #3b3b3b;
      background: rgba(255,255,255,0.05);
      position: relative;
    }
    .plant, .zombie {
      position: absolute;
      width: 60px; height: 80px;
      pointer-events: none;
      transition: left 0.3s, top 0.3s;
    }
    .plant { z-index: 2; }
    .zombie { z-index: 3; }
    #plantBar {
      margin: 20px auto;
      width: 640px;
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    .plantIcon {
      width: 60px; height: 60px;
      border: 2px solid #3b3b3b;
      background: #a3e635;
      cursor: pointer;
    }
    #sunCounter {
      font-size: 24px; font-weight: bold;
      color: #fff; background: #fdfd96; padding: 5px 15px; border-radius: 15px;
      margin-bottom: 10px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div id="sunCounter">Sun: <span id="sunValue">150</span></div>
  <div id="plantBar">
    <div class="plantIcon" data-plant="pea" title="Peashooter (100 sun)">ðŸŒ±</div>
    <div class="plantIcon" data-plant="sunflower" title="Sunflower (50 sun)">ðŸŒ»</div>
    <!-- Add more plants here -->
  </div>
  <div id="gameBoard"></div>
  <script>
    const ROWS = 5, COLS = 9;
    const gameBoard = document.getElementById('gameBoard');
    let selectedPlant = null;
    let sun = 150;
    let plants = [];
    let zombies = [];
    let cellRects = [];

    // Initialize grid
    for(let r=0; r<ROWS; r++) {
      for(let c=0; c<COLS; c++) {
        let cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.row = r;
        cell.dataset.col = c;
        gameBoard.appendChild(cell);
      }
    }

    // Get grid cell positions for placing elements
    function updateCellRects() {
      cellRects = [];
      let cells = document.querySelectorAll('.cell');
      cells.forEach(cell => {
        cellRects.push(cell.getBoundingClientRect());
      });
    }

    window.onload = updateCellRects;
    window.onresize = updateCellRects;

    // Plant selection
    document.querySelectorAll('.plantIcon').forEach(icon => {
      icon.onclick = function() {
        selectedPlant = this.dataset.plant;
        document.querySelectorAll('.plantIcon').forEach(i => i.style.background = '#a3e635');
        this.style.background = '#fdfd96';
      };
    });

    // Plant costs
    const plantData = {
      pea: { cost: 100, emoji: 'ðŸŒ±' },
      sunflower: { cost: 50, emoji: 'ðŸŒ»' }
    };

    // Place plant
    gameBoard.addEventListener('click', function(e) {
      if(!selectedPlant) return;
      if(e.target.classList.contains('cell')) {
        let row = +e.target.dataset.row, col = +e.target.dataset.col;
        let exists = plants.find(p => p.row === row && p.col === col);
        if(exists) return;
        let cost = plantData[selectedPlant].cost;
        if(sun < cost) return;
        sun -= cost;
        document.getElementById('sunValue').textContent = sun;
        let plant = { type: selectedPlant, row, col, hp: 5 };
        plants.push(plant);
        renderPlant(plant);
      }
    });

    // Render plant
    function renderPlant(p) {
      let cell = document.querySelector(`.cell[data-row="${p.row}"][data-col="${p.col}"]`);
      let el = document.createElement('div');
      el.className = 'plant';
      el.style.left = '5px';
      el.style.top = '5px';
      el.textContent = plantData[p.type].emoji;
      cell.appendChild(el);
      p.el = el;
    }

    // Spawn zombies randomly
    setInterval(function() {
      let row = Math.floor(Math.random() * ROWS);
      let zombie = { row, col: COLS-1, hp: 10 };
      zombies.push(zombie);
      renderZombie(zombie);
    }, 4000);

    // Render zombie
    function renderZombie(z) {
      let cell = document.querySelector(`.cell[data-row="${z.row}"][data-col="${z.col}"]`);
      let el = document.createElement('div');
      el.className = 'zombie';
      el.style.left = '5px';
      el.style.top = '5px';
      el.textContent = 'ðŸ§Ÿ';
      cell.appendChild(el);
      z.el = el;
    }

    // Move zombies
    setInterval(function() {
      zombies.forEach(z => {
        if(z.col > 0) {
          // Check for plant in next cell
          let hit = plants.find(p => p.row === z.row && p.col === z.col-1);
          if(hit) {
            hit.hp -= 1;
            if(hit.hp <= 0) {
              hit.el.remove();
              plants = plants.filter(p => p !== hit);
            }
          } else {
            z.col -= 1;
            let cell = document.querySelector(`.cell[data-row="${z.row}"][data-col="${z.col}"]`);
            cell.appendChild(z.el);
          }
        } else {
          // Zombie reached house
          alert("A zombie got through! Game Over!");
          location.reload();
        }
      });
    }, 1200);

    // Sun generation
    setInterval(function() {
      sun += 25;
      document.getElementById('sunValue').textContent = sun;
    }, 4000);

  </script>
</body>
</html>
